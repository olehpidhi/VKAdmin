<!DOCTYPE html>
<html ng-app = "VKAdmin">
<script type="text/javascript" src = "js/jquery-2.1.3.min.js"></script>
<script src="js/angular.min.js"></script>
<script src="js/angular-file-upload.js"></script>
<script type="text/javascript" src = "js/angular-cookies.js"></script>
<script type="text/javascript" src = "js/vk_api.js"></script>
<script type="text/javascript" src = "js/app.js"></script>

<head>
	<title></title>
</head>
<body >
	<div ng-controller = "StatisticsController"> </div>

	<!-- Posting section begin -->
	<div ng-controller = "PostingController" ng-init = "init()">
		<label>Select group:</label>
		<br>

		<select id = "groups-select">
			<option value = "All">All</option>
			<option ng-repeat = "group in groups" value = {{group.gid}}>{{group.name}}</option>
		</select>
		<br>

		<textarea ng-model = "postText" required></textarea>
		<br>

		<!-- File upload -->
		<input type="file" nv-file-select uploader="uploader" ng-click="resolveUploadURL()"/><br/>
		<ul>
			<li ng-repeat="item in uploader.queue">
				Name: <span ng-bind="item.file.name"></span><br/>
				<button ng-click="item.upload()">upload</button>
			</li>
		</ul>
		<!-- File upload end -->

		<!-- Uploading by dragging into drop area -->
		<ul oi-file="options">
			<li ng-repeat="item in items">
				<img ng-src="{{item.thumb}}"> 
			</li>
		</ul>

		<br>
		<label>
			<input type="checkbox" ng-model = "fromGroup"/>From group?
		</label>
		<a href="#" ng-click = "post()">Post</a>
	</div>
	<!-- Postring section end -->

	<!-- Wall section begin -->
	<div ng-controller = "WallController">
		<!-- Error message -->
		<p>{{message}}</p>
		<!-- Error message -->
		<a href="#" ng-click="getPosts()">Show posts</a> 
		<ul>
			<li ng-repeat = "post in posts">
				<div ng-show="!deleted[$index]"> 
					<img ng-src="{{post.owner.photo}}"/>
					<p>{{post.owner.first_name+post.owner.name}}</p>
					<p>{{post.owner.last_name}}</p>
					<div ng-bind="post.text">
					</div>
					<div ng-show = "editing[$index]">
						<textarea ng-model="post.text"></textarea>
						<a href="#" ng-click="editPost(post.id, post.text, $index)">Confirm</a>
						<a href="#" ng-click="cancelEdit($index)">Cancel</a>
					</div>

					<a href="#" ng-click="beginEdit($index)" ng-show = "post.can_edit&&!editing[$index]">Edit</a>
					<a href="#" ng-click="deletePost(post.id, $index)" ng-show = "post.can_delete">Delete Post</a>
					<a href="#" ng-click="getComments(post.id, $index)">Show Comments</a>
					<a href="#" ng-click="hideComments($index)">Hide Comments</a>
					<!-- Comments section -->
					<div ng-show = "commentsShow[$index]">
						<ul>
							<li ng-repeat="comment in comments[$index]"  >
								<div ng-show="!(comment.deleted||comment.editing)">
									<!-- Comment data section begin -->
									<img ng-src="{{comment.owner.photo_50}}"/>
									<p>{{comment.owner.name}} {{comment.owner.first_name}} {{comment.owner.last_name}} </p>
									<div ng-bind="comment.text"> </div>
									<!-- Comment data section end -->

									<!-- Comment edit section begin -->
									<div ng-show = "comment.editing">
										<textarea ng-model="comment.text"></textarea>
										<a href="#" ng-click="editComment(comment.id, comment.text, $parent.$index, $index)" >Confirm</a>
										<a href="#" ng-click="cancelEdit($parent.$index,$index)">Cancel</a>
									</div>
									<!-- Comment edit section end -->

									<!-- Comment control secton begin -->
									<a href="#" ng-click="beginEditComment($parent.$index,$index)" ng-show = "comment.can_edit">Edit</a>
									<a href="#" ng-click="deleteComment(comment.id, $parent.$index ,$index); getComments(post.id, $index)">Delete Comment</a>
									<a href="#" ng-click="beginReply(comment.id, $parent.$index)" ng-show = "true">Reply</a>
									<!-- Comment control secton begin -->
								</div>
								<!-- Comment deleted message begin -->
								<div ng-show="comment.deleted">
									Comment has been deleted. <a href="#" ng-click="restoreComment(comment.id, $parent.$index ,$index)">Restore?</a>
								</div>
								<!-- Comment deleted message end -->
							</li>
						</ul>
						<!-- Add comment section begin -->
						<textarea ng-model="commentText" id="commentText{{$index}}"></textarea>
						<a href="#" ng-click="addComment(post.id, commentFromGroup ? 1 : 0 ,commentText, replyTo)" >Add Comment</a>
						<label>
							<input type="checkbox" ng-model = "commentFromGroup"/>From group?
						</label>
						<a href="#" ng-click="getComments(post.id, $index)">Show more comments </a>
						<!-- Add comment section end -->
					</div>
					<!-- Comments section end -->
				</div>
				<div ng-show="deleted[$index]">
					The post have been deleted. <a href="#" ng-click="restorePost(post.id, $index)">Restore?</a>
				</div>
			</li>
		</ul>
	</div>
	<a href="#" ng-click="getPosts()">Show more posts</a>
	<!-- Wall section end -->
</body>
</html>