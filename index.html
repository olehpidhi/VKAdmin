<!DOCTYPE html>
<html ng-app = "VKAdmin">
<script type="text/javascript" src = "js/jquery-2.1.3.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>

<script type="text/javascript" src = "js/vk_api.js"></script>
<script type="text/javascript" src = "js/app.js"></script>
<head>
	<title></title>
</head>
<body >
	<div ng-controller = "StatisticsController"> </div>

	<!-- Posting section begin -->
	<div ng-controller = "PostingController" ng-init = "init()">
		<label>Select group:</label>
		<br>

		<select id = "groups-select">
			<option value = "All">All</option>
			<option ng-repeat = "group in groups" value = {{group.gid}}>{{group.name}}</option>
		</select>
		<br>

		<textarea ng-model = "postText" required></textarea>
		<br>

		<form enctype="multipart/form-data" id = "uploader-form">
			<input name="file" type="file"  id="file-uploader"/>
			<input type="button" value="Upload" ng-click="uploadPhoto()"/>
		</form>

		<br>
		<label>
			<input type="checkbox" ng-model = "fromGroup"/>From group?
		</label>
		<a href="#" ng-click = "post()">Post</a>
	</div>
	<!-- Postring section end -->

	<!-- Wall section begin -->
	<div ng-controller = "WallController">
		<!-- Error message -->
		<p>{{message}}</p>
		<!-- Error message -->
		<a href="#" ng-click="getPosts()">Show posts</a> 
		<ul>
			<li ng-repeat = "post in posts">
				<div ng-show="!deleted[$index]"> 
					<div ng-bind="post.text">
					</div>
					<div ng-show = "editing[$index]">
						<textarea ng-model="post.text"></textarea>
						<a href="#" ng-click="editPost(post.id, post.text, $index)">Confirm</a>
						<a href="#" ng-click="cancelEdit($index)">Cancel</a>
					</div>

					<a href="#" ng-click="beginEdit($index)" ng-show = "post.can_edit&&!editing[$index]">Edit</a>
					<a href="#" ng-click="deletePost(post.id, $index)" ng-show = "post.can_delete">Delete Post</a>
					<a href="#" ng-click="getComments(post.id, $index)">Show Comments</a>
					<!-- Comments section -->
					<div ng-show = "commentsShow[$index]">
						<ul>
							<li ng-repeat="comment in comments[$index]"  >
								<div ng-show="!(comment.deleted||comment.editing)">
									<img/>
									<div ng-bind="comment.text"> </div>
									<!-- Comment edit section begin -->
									<div ng-show = "comment.editing">
										<textarea ng-model="comment.text"></textarea>
										<a href="#" ng-click="editComment(comment.id, comment.text, $parent.$index, $index)" >Confirm</a>
										<a href="#" ng-click="cancelEdit($parent.$index,$index)">Cancel</a>
									</div>
									<!-- Comment edit section end -->

									<!-- Comment control secton begin -->
									<a href="#" ng-click="beginEditComment($parent.$index,$index)" ng-show = "comment.can_edit">Edit</a>
									<a href="#" ng-click="deleteComment(comment.id, $parent.$index ,$index)">Delete Comment</a>
									<a href="#" ng-click="beginReply(comment.id)" ng-show = "true">Reply</a>
									<!-- Comment control secton begin -->
								</div>
								<!-- Comment deleted message begin -->
								<div ng-show="comment.deleted">
									Comment has been deleted. <a href="#" ng-click="restoreComment(comment.id, $parent.$index ,$index)">Restore?</a>
								</div>
								<!-- Comment deleted message end -->
							</li>
						</ul>
						<!-- Add comment section begin -->
						<textarea ng-model="commentText" id="commentText"></textarea>
						<a href="#" ng-click="addComment(post.id, commentFromGroup ? 1 : 0 ,commentText, replyTo)" >Add Comment</a>
						<label>
							<input type="checkbox" ng-model = "commentFromGroup"/>From group?
						</label>
						<!-- Add comment section end -->
					</div>
					<!-- Comments section -->
				</div>
				<div ng-show="deleted[$index]">
					The post have been deleted. <a href="#" ng-click="restorePost(post.id, $index)">Restore?</a>
				</div>		

			</li>
		</ul>
	</div>
	<!-- Wall section end -->
</body>
</html>